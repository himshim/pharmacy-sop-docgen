/**
 * ═══════════════════════════════════════════════════════════════════
 * SOP PRINT STYLES - FINAL MOBILE & PRINT FIX
 * ═══════════════════════════════════════════════════════════════════
 */

/* ============ 1. PAGE SETUP ============ */
@page {
    size: A4 portrait;
    margin: 15mm; /* Slightly safer margin */
}

/* ============ 2. DESKTOP PREVIEW ============ */
#preview-wrapper {
    background: #525659;
    padding: 30px 0;
    overflow: auto;
    height: 100vh;
    display: block;
    text-align: center;
}

#preview {
    width: 210mm !important;
    min-height: 297mm !important;
    height: auto !important;
    margin: 0 auto;
    padding: 20mm !important;
    background: white !important;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    text-align: left;
    display: inline-block;
    position: relative;
    box-sizing: border-box;

    font-family: "Times New Roman", Times, serif !important;
    font-size: 12pt !important;
    line-height: 1.5 !important;
    color: #000 !important;
}

/* ============ 4. MOBILE PREVIEW (Scrollable - High Fidelity) ============ */
@media screen and (max-width: 850px) {
    #preview-wrapper {
        display: block !important;
        padding: 20px 10px !important;
        /* Allow horizontal scroll so the A4 paper keeps its integrity */
        overflow-x: auto !important; 
        -webkit-overflow-scrolling: touch;
        background: #f0f0f5 !important;
        text-align: left !important; /* Align left so scrolling feels natural */
    }

    #preview {
        /* Keep Exact A4 dimensions - DO NOT SHRINK */
        /* Shrinking breaks the "Word-like" layout flow */
        width: 210mm !important;
        min-width: 210mm !important;
        
        /* No Transform - Just let it be a document */
        transform: none !important; 
        margin: 0 auto !important;
        
        /* Ensure it looks like a paper */
        box-shadow: 0 2px 5px rgba(0,0,0,0.2) !important;
    }
}

/* ============ 4. PRINT FIX (The "Blank Page" Killer) ============ */
@media print {
    /* RESET EVERYTHING */
    :root, html, body {
        width: 100% !important;
        height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: visible !important;
        background: white !important;
        display: block !important;
    }

    /* HIDE UI */
    .app-container, header, nav, footer, aside,
    .controls-panel, .status-bar, .toolbar-buttons,
    .mobile-header, .tab-navigation, .preview-toolbar,
    .page-break-indicator, .tab-panel:not(#tab-preview) {
        display: none !important;
    }

    /* UNWRAP CONTENT */
    #preview-wrapper, .mobile-content, .tab-panel, .content {
        position: static !important;
        display: block !important;
        overflow: visible !important;
        height: auto !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        background: transparent !important;
        transform: none !important;
        border: none !important;
    }

    /* FORCE PAGE VISIBILITY */
    #preview {
        /* Let the printer determine width */
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        
        /* Reset positioning */
        margin: 0 !important;
        padding: 0 !important; /* Margins handled by @page */
        position: static !important;
        
        display: block !important;
        visibility: visible !important;
        overflow: visible !important;
        
        /* Disable effects */
        transform: none !important;
        box-shadow: none !important;
        border: none !important;
        float: none !important;
    }
    
    /* Ensure content inside prints */
    #preview * {
        visibility: visible !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
    
    /* Page Breaks */
    .page-break-before { page-break-before: always !important; height: 1px; display: block; }
    h1, h2 { page-break-after: avoid !important; }
    table, tr, td { page-break-inside: avoid !important; }
}
