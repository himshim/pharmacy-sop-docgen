/**
 * ═══════════════════════════════════════════════════════════════════
 * MS WORD A4 WYSIWYG PRINT STYLES
 * Matches Microsoft Word's default A4 layout (210mm x 297mm)
 * ═══════════════════════════════════════════════════════════════════
 */

/* ============ 1. PAGE SETUP (The Foundation) ============ */
@page {
    size: A4 portrait;      /* 210mm x 297mm */
    margin: 20mm;           /* Word 'Normal' Margins */
}

/* ============ 2. PAGE BREAK UTILITIES (Like Word Section Breaks) ============ */
.page-break-before {
    page-break-before: always !important;
    break-before: page !important;
    display: block;
    height: 0;
    margin: 0;
}

.page-break-after {
    page-break-after: always !important;
    break-after: page !important;
}

/* ============ 3. SCREEN PREVIEW (WYSIWYG Mode) ============ */
#preview-wrapper {
    background: #525659;    /* Dark grey background like Word/Acrobat */
    padding: 40px 0;        /* Spacing around the paper */
    overflow-y: auto;
    height: 100%;
    display: flex;
    justify-content: center;
}

#preview {
    /* Exact A4 Dimensions */
    width: 210mm !important;
    min-height: 297mm !important; 
    padding: 20mm !important; /* Matches @page margin */
    
    /* Paper Look */
    background: white !important;
    box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    margin: 0 auto;
    box-sizing: border-box;
    
    /* Typography - Word Defaults */
    font-family: "Times New Roman", Times, serif !important;
    font-size: 12pt !important;
    line-height: 1.5 !important;
    color: #000000 !important;
    text-align: justify;
}

/* ============ 4. PRINT MODE (Printer Output) ============ */
@media print {
    body {
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
    }

    /* Hide EVERYTHING except the document */
    .app-container, header, nav, .controls-panel, .status-bar, 
    .toolbar-buttons, button, .mobile-header, .tab-navigation,
    .page-break-indicator {
        display: none !important;
    }

    /* Reset Preview Wrapper */
    #preview-wrapper {
        background: white !important;
        padding: 0 !important;
        height: auto !important;
        display: block !important;
        overflow: visible !important;
    }

    /* The Document Itself */
    #preview {
        width: 100% !important; /* Let @page handle width */
        margin: 0 !important;
        padding: 0 !important;  /* @page handles margins */
        box-shadow: none !important;
        min-height: 0 !important;
        border: none !important;
    }

    /* Ensure backgrounds print (for table headers) */
    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
}

/* ============ 5. CONTENT STYLES (Word-like formatting) ============ */
/* Headings */
#preview h1 {
    font-size: 16pt;
    font-weight: bold;
    text-transform: uppercase;
    text-align: center;
    margin-bottom: 24pt;
    border-bottom: 2px solid #000;
    padding-bottom: 4pt;
}

#preview h2 {
    font-size: 14pt;
    font-weight: bold;
    margin-top: 18pt;
    margin-bottom: 12pt;
    background-color: #f2f2f2; /* Light grey background */
    padding: 2pt 8pt;
    border-left: 4pt solid #000;
}

#preview h3 {
    font-size: 12pt;
    font-weight: bold;
    margin-top: 14pt;
    margin-bottom: 6pt;
    text-decoration: underline;
}

/* Paragraphs */
#preview p {
    margin-bottom: 12pt;
    widows: 3;
    orphans: 3;
}

/* Lists */
#preview ul, #preview ol {
    margin-bottom: 12pt;
    padding-left: 24pt;
}

#preview li {
    margin-bottom: 4pt;
}

/* Tables (Word Style Grid) */
#preview table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 14pt;
    border: 1px solid #000;
    page-break-inside: avoid;
}

#preview th, #preview td {
    border: 1px solid #000;
    padding: 6pt;
    vertical-align: top;
    font-size: 11pt;
}

#preview th {
    background-color: #e6e6e6;
    font-weight: bold;
    text-align: center;
}

/* Page Break Indicator (Screen Only) */
.page-break-indicator {
    border-top: 1px dashed #999;
    color: #999;
    font-size: 10px;
    text-align: center;
    margin: 20px 0;
    position: relative;
    pointer-events: none;
}
.page-break-indicator::before {
    content: "--- Page Break ---";
    background: #525659;
    color: white;
    padding: 2px 8px;
    position: relative;
    top: -10px;
}
