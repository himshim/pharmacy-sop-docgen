<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pharmacy SOP Generator</title>
  <base href="/pharmacy-sop-docgen/" />


  <!-- REQUIRED for mobile compatibility -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- UI styles -->
  <link rel="stylesheet" href="css/ui-desktop.css" />
  <link rel="stylesheet" href="css/ui-mobile.css" />

  <!-- Print -->
  <link rel="stylesheet" href="css/print-a4.css" />
</head>

<body>

  <!-- UI MOUNT POINT -->
  <div id="app"></div>

  <!-- CREDIT (SCREEN ONLY) -->
  <footer class="app-footer">
    Created by
    <a href="https://github.com/himshim" target="_blank">@himshim26</a>
    Â·
    <a href="https://github.com/himshim/pharmacy-sop-docgen" target="_blank">
      Source Code
    </a>
  </footer>

  <!-- UI LOADER -->
  <script>
    async function loadUI() {
      const app = document.getElementById("app");
      if (!app) return;

      const isMobile = window.matchMedia("(max-width: 768px)").matches;
      const uiFile = isMobile
        ? "partials/ui-mobile.html"
        : "partials/ui-desktop.html";

      try {
        const html = await fetch(`${uiFile}?v=${Date.now()}`).then(r => r.text());
        app.innerHTML = html;

        // ðŸ”¥ IMPORTANT: initialize logic ONLY after UI exists
        if (window.initSOPApp) {
          window.initSOPApp();
        }
      } catch (e) {
        app.innerHTML = "<p style='color:red'>Failed to load UI</p>";
        console.error(e);
      }
    }

    loadUI();
  </script>

  <!-- LOGIC (shared) -->
  <script src="js/template-engine.js"></script>
  <script src="js/sop-engine.js"></script>

  app.innerHTML = html;

// ðŸ”¥ Edge needs a tick
setTimeout(() => {
  window.initSOPApp?.();
}, 0);

</body>
</html>
